{"key":"tool_get_document","name":"","instructions":"","requirecss":"","requirejs":"","shim":"","defaults":"","amd":"1","body":"<a class=\"doc-link  target=\"_blank\" style=\"text-decoration: none; display: inline-flex; align-items: center; font-size: 18px;\">\n<img src=\"https://upload.wikimedia.org/wikipedia/commons/f/fd/Microsoft_Office_Word_%282019%E2%80%93present%29.svg\" alt=\"document icon\" style=\"width: 32px; height: 32px; margin-right: 18px;\">\n  Η Πρόταση μου</a>\n<!--<div class=\"cryptpad-container\" style=\"width:100%; height:600px; border:1px solid #ccc;\"></div>-->","bodyend":"","script":"(async function() {\n  const pool = [   \"https://docs.google.com/document/d/11Gt-D9lv_BCf_LMTT5HPgPiUlZ3ZK7Yj/edit?usp=drivesdk&ouid=116688872255814112677&rtpof=true&sd=true\",\n\"https://docs.google.com/document/d/12Rg-kyFp_s6PuLSEd2U3tSnzKhZa7RUj/edit?usp=drivesdk&ouid=116688872255814112677&rtpof=true&sd=true\",\n\"https://docs.google.com/document/d/13JFzLx6HFG7WaPFvPiMdkzVbjshTJPKF/edit?usp=drivesdk&ouid=116688872255814112677&rtpof=true&sd=true\",\n\"https://docs.google.com/document/d/16TgRHKFmslDp4KRaNN-6FCL0-5Ri1OSv/edit?usp=drivesdk&ouid=116688872255814112677&rtpof=true&sd=true\",\n\"https://docs.google.com/document/d/18HJK8yJSvSdy2J1-9NR4w2OitjpNMMLa/edit?usp=drivesdk&ouid=116688872255814112677&rtpof=true&sd=true\",\n\"https://docs.google.com/document/d/19tUtCenfYdTZ0WNJt7kfFIJZD_ZGqHGg/edit?usp=drivesdk&ouid=116688872255814112677&rtpof=true&sd=true\",\n\"https://docs.google.com/document/d/1ABKi4eBMeE1EzUvRpxRVhxapI_3wyo7J/edit?usp=drivesdk&ouid=116688872255814112677&rtpof=true&sd=true\",\n\"https://docs.google.com/document/d/1ALiY7qRxix1cYw9ItCjT_b_g-S5Dx71l/edit?usp=drivesdk&ouid=116688872255814112677&rtpof=true&sd=true\",\n\"https://docs.google.com/document/d/1Am3JmWC13fKYXP2td5JPyrqa0soD2om4/edit?usp=drivesdk&ouid=116688872255814112677&rtpof=true&sd=true\",\n\"https://docs.google.com/document/d/1bpvETx3YzLlVT_1_Yf7RZSf169lEa7zM/edit?usp=drivesdk&ouid=116688872255814112677&rtpof=true&sd=true\",\n\"https://docs.google.com/document/d/1-bY9hqzhC2Qlr8tZ8JPsSkRY3X5oqUEd/edit?usp=drivesdk&ouid=116688872255814112677&rtpof=true&sd=true\",\n\"https://docs.google.com/document/d/1C9J1T5wXlj1m_82gwzP08Q6-k4lDO0So/edit?usp=drivesdk&ouid=116688872255814112677&rtpof=true&sd=true\",\n\"https://docs.google.com/document/d/1DVWZzxdxm985QUiCKySW5Klw3wwwA9Yg/edit?usp=drivesdk&ouid=116688872255814112677&rtpof=true&sd=true\",\n\"https://docs.google.com/document/d/1ec7ior3YGYRh126BhVxwiAdlE8zYsOII/edit?usp=drivesdk&ouid=116688872255814112677&rtpof=true&sd=true\",\n\"https://docs.google.com/document/d/1euf-NgA-DBbzVIPykhf_HydyLYTpQvnd/edit?usp=drivesdk&ouid=116688872255814112677&rtpof=true&sd=true\",\n\"https://docs.google.com/document/d/1FN8N057xA_i2WR3wTQG4dASXGnS-Tlpi/edit?usp=drivesdk&ouid=116688872255814112677&rtpof=true&sd=true\",\n\"https://docs.google.com/document/d/1J6Q_YRcvL9jxN7dCEGSRW_s9LhlukDIk/edit?usp=drivesdk&ouid=116688872255814112677&rtpof=true&sd=true\",\n\"https://docs.google.com/document/d/1KCXYSPTDxTffn_T1NQ2BlSXE3Uop1N5q/edit?usp=drivesdk&ouid=116688872255814112677&rtpof=true&sd=true\",\n\"https://docs.google.com/document/d/1kG_i1AgXRgAAqezE5JLSDb9rKI89yZ4J/edit?usp=drivesdk&ouid=116688872255814112677&rtpof=true&sd=true\",\n\"https://docs.google.com/document/d/1KgqiJGPYENCPL7fI7qWgO6lBI9bFI9BC/edit?usp=drivesdk&ouid=116688872255814112677&rtpof=true&sd=true\",\n\"https://docs.google.com/document/d/1KXW-7yZgIV3fvO9YBZNifyXZxWtWV1Lo/edit?usp=drivesdk&ouid=116688872255814112677&rtpof=true&sd=true\",\n\"https://docs.google.com/document/d/1lEfLZETwgzKKTj_TwEMwMuKBHMcVDPyR/edit?usp=drivesdk&ouid=116688872255814112677&rtpof=true&sd=true\",\n\"https://docs.google.com/document/d/1m40sR0Cth3tKOSoOJzrYugENvsMl-TgU/edit?usp=drivesdk&ouid=116688872255814112677&rtpof=true&sd=true\",\n\"https://docs.google.com/document/d/1Mjmo-HCcDhq8rYqW8frOyGJXNbR1Ap4g/edit?usp=drivesdk&ouid=116688872255814112677&rtpof=true&sd=true\",\n\"https://docs.google.com/document/d/1MLpbWmOPGTx9d16YA31FMjHUbLT-Scol/edit?usp=drivesdk&ouid=116688872255814112677&rtpof=true&sd=true\",\n\"https://docs.google.com/document/d/1MM5sMq6vFzLkmOUcw3427z-6oPPrZzWQ/edit?usp=drivesdk&ouid=116688872255814112677&rtpof=true&sd=true\",\n\"https://docs.google.com/document/d/1mmf3A_v7mhhBEy5xvFCaFH2E0dlhyP2H/edit?usp=drivesdk&ouid=116688872255814112677&rtpof=true&sd=true\",\n\"https://docs.google.com/document/d/1mVL2nnVMFdYRJPB9FanJofeGo0X8-B_i/edit?usp=drivesdk&ouid=116688872255814112677&rtpof=true&sd=true\",\n\"https://docs.google.com/document/d/1mwGxEsD2rUVHHZYplS3kE4-4Thy43dxj/edit?usp=drivesdk&ouid=116688872255814112677&rtpof=true&sd=true\",\n\"https://docs.google.com/document/d/1NeFKSkziOi2_Ybr903rxNKVJ0sCaccwU/edit?usp=drivesdk&ouid=116688872255814112677&rtpof=true&sd=true\",\n\"https://docs.google.com/document/d/1o2iQqFw0PR9wUyF7iG828WltyKRMD-_w/edit?usp=drivesdk&ouid=116688872255814112677&rtpof=true&sd=true\",\n\"https://docs.google.com/document/d/1p5Jw6pM_v1Sgl9aSram9Ck9w9vTf7l1t/edit?usp=drivesdk&ouid=116688872255814112677&rtpof=true&sd=true\",\n\"https://docs.google.com/document/d/1pKll4H0q7O6WLuhEO4JPHB53cROlsUJp/edit?usp=drivesdk&ouid=116688872255814112677&rtpof=true&sd=true\",\n\"https://docs.google.com/document/d/1Qg10GH-EhH1f_QkOU7kCvw8NjBqEDZeG/edit?usp=drivesdk&ouid=116688872255814112677&rtpof=true&sd=true\",\n\"https://docs.google.com/document/d/1qQH4cjW9xfQafmGenLisvMGbLXU1OFqw/edit?usp=drivesdk&ouid=116688872255814112677&rtpof=true&sd=true\",\n\"https://docs.google.com/document/d/1qRK1KlpkV7PhfhNGmq8qll5r8Qzpm9Oh/edit?usp=drivesdk&ouid=116688872255814112677&rtpof=true&sd=true\",\n\"https://docs.google.com/document/d/1r9TMwmCw4v0ZTRiwvgeR12-V3Ix38gPy/edit?usp=drivesdk&ouid=116688872255814112677&rtpof=true&sd=true\",\n\"https://docs.google.com/document/d/1RzVABovvU3lWRzmiQHwLbJY4GbIR7iXo/edit?usp=drivesdk&ouid=116688872255814112677&rtpof=true&sd=true\",\n\"https://docs.google.com/document/d/1su4LNY1wSoWX0fw-jZG8QGAMrFM41hgQ/edit?usp=drivesdk&ouid=116688872255814112677&rtpof=true&sd=true\",\n\"https://docs.google.com/document/d/1SuSOXwSMe-tZzFZm0dpPQqRUQSi2xc72/edit?usp=drivesdk&ouid=116688872255814112677&rtpof=true&sd=true\",\n\"https://docs.google.com/document/d/1SYA09ZhWXDVPCrByrd2o2NYu0esNh40n/edit?usp=drivesdk&ouid=116688872255814112677&rtpof=true&sd=true\",\n\"https://docs.google.com/document/d/1t6CxywlPou6OfL8AtgpcLvAi4A81SdxY/edit?usp=drivesdk&ouid=116688872255814112677&rtpof=true&sd=true\",\n\"https://docs.google.com/document/d/1tUot32M5koSBJn_Pg5K83kSXBCrPbael/edit?usp=drivesdk&ouid=116688872255814112677&rtpof=true&sd=true\",\n\"https://docs.google.com/document/d/1uMqZ1kY8oTycTFjBeXz3sni51muIY3Ht/edit?usp=drivesdk&ouid=116688872255814112677&rtpof=true&sd=true\",\n\"https://docs.google.com/document/d/1urI38uSG_jArJmJ0aRJUzIapK6z6Z7px/edit?usp=drivesdk&ouid=116688872255814112677&rtpof=true&sd=true\",\n\"https://docs.google.com/document/d/1w9_kFtr2FABlNTTinVQZEpBJ2nqe5f3j/edit?usp=drivesdk&ouid=116688872255814112677&rtpof=true&sd=true\",\n\"https://docs.google.com/document/d/1wmvOx2ukRNrU4pNaW3AknfuTGiwje2W9/edit?usp=drivesdk&ouid=116688872255814112677&rtpof=true&sd=true\",\n\"https://docs.google.com/document/d/1XIfixOIFpzWRjOYRkwX91o9G42OFWqcH/edit?usp=drivesdk&ouid=116688872255814112677&rtpof=true&sd=true\",\n\"https://docs.google.com/document/d/1x-V9k0FHo2mBgJdOzQn3TgYZrim0HyLP/edit?usp=drivesdk&ouid=116688872255814112677&rtpof=true&sd=true\",\n\"https://docs.google.com/document/d/1zUBQBYZCCXHCKrom25o_L8Go4eQ_J2TJ/edit?usp=drivesdk&ouid=116688872255814112677&rtpof=true&sd=true\"];\n  const username = \"@@USER:username@@\";\n\n  async function sha256Hex(s) {\n    const enc = new TextEncoder().encode(s);\n    const buf = await crypto.subtle.digest(\"SHA-256\", enc);\n    return Array.from(new Uint8Array(buf)).map(b => b.toString(16).padStart(2,\"0\")).join(\"\");\n  }\n  function hexToBigIntPrefix(hex, n = 16) { return BigInt(\"0x\" + hex.slice(0, n)); }\n\n  async function rendezvousOrder(user, pads) {\n    const arr = [];\n    for (const pad of pads) {\n      const h = await sha256Hex(user + \"|\" + pad);\n      arr.push({ pad, score: hexToBigIntPrefix(h, 16) });\n    }\n    arr.sort((a,b) => (a.score < b.score ? 1 : (a.score > b.score ? -1 : 0)));\n    return arr.map(x => x.pad);\n  }\n\n  async function claimPad(user, pad) {\n    const url = M.cfg.wwwroot + \"/local/padmap/ajax.php\";\n    const res = await fetch(url, {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\", \"X-Requested-With\": \"fetch\" },\n      credentials: \"same-origin\",\n      body: JSON.stringify({ action: \"claim\", username: user, pad, sesskey: M.cfg.sesskey })\n    });\n    if (!res.ok) throw new Error(\"Network error\");\n    return res.json();\n  }\n\n  try {\n    const ordered = await rendezvousOrder(username, pool);\n    let assigned = null;\n    for (const candidate of ordered) {\n      const r = await claimPad(username, candidate);\n      if (r.status === \"ok\" || r.status === \"already\") { assigned = r.pad; break; }\n      // if taken → δοκίμασε επόμενο\n    }\n    if (!assigned) throw new Error(\"No pad available\");\n    document.querySelector(\".doc-link\")?.setAttribute(\"href\", assigned);\n    // ή:\n    // document.querySelector(\".cryptpad-container\").innerHTML = `<iframe src=\"${assigned}\" width=\"100%\" height=\"100%\" style=\"border:0;\">`;\n  } catch (e) {\n    console.error(e);\n  }\n})();\n","style":"","dataset":"","datasetvars":"","alternate":"","alternateend":"","version":""}